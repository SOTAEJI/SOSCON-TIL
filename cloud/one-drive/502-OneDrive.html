<script type="text/javascript">
    RED.nodes.registerType("OneDrive", {
        category: "storage",
        color: "#0078d4",
        defaults: {
            name: {
                value: "",
                type: "text",
            },
            accessToken: {
                type: "text",
                required: true,
            },
            doType: {
                value: "",
                type: "text",
                required: true,
            },
            fileName: {
                value: "",
                type: "text",
            },
            filePath: {
                value: "",
                type: "text",
            },
        },
        icon: "onedrive.png",
        inputs: 1,
        outputs: 1,
        label(){
            return this.name || "OneDrive"
        },
        oneditprepare: function() {
			$("#node-input-doType").on("change", function() {
				const val = $(this).val();
                if (val === 'read') {
                    $("#node-input-filePath-row").hide();
                } else {
                    $("#node-input-filePath-row").show();
                }
			});
		}
    })
</script>
<script type="text/html" data-template-name="OneDrive">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-accessToken"><i class="fa fa-tag"></i> Access Token</label>
        <input type="text" id="node-input-accessToken" placeholder="Access Token">
    </div>
    <div class="form-row">
        <label for="node-input-doType"><i class="fa fa-hdd-o"></i> What to do</label>
        <select id="node-input-doType">
            <option value="" selected>Select What to do</option>
            <option value="download">Download to Local</option>
            <option value="upload">Upload to OneDrive</option>
            <option value="read">Read a File</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-fileName"><i class="fa fa-file-text-o"></i> File Name</label>
        <input type="text" id="node-input-fileName" placeholder="example.png">
    </div>
    <div class="form-row" id="node-input-filePath-row">
        <label for="node-input-filePath"><i class="fa fa-folder-o"></i> File Path</label>
        <input type="text" id="node-input-filePath" placeholder="C:/">
    </div>
</script>
<script type="text/html" data-help-name="OneDrive">
    <dt>What to do</dt>
    <dd>You can choose download or upload mode.</dd>
    <dt>File ID</dt>
    <dd>Enter the ID of the file on the drive.</dd>
    <dt>File Name</dt>
    <dd>
      Enter the name of the file to be saved in Local Or the name of the file to
      be saved in Drive.
    </dd>
    <dt>File Path</dt>
    <dd>
      Enter the path without the file name when downloading. And enter the Full
      Path(with file name) when uploading.
    </dd>
    <dt>Data Type</dt>
    <dd>You must select the data type of the file.</dd>
</script>
